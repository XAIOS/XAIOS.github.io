KWhale={};KWhale.Go=function(c){var b=this;requestAnimationFrame(function e(){c();b.running=requestAnimationFrame(e)})};KWhale.Child=function(){};KWhale.Child.prototype.FadeIn=function(){KWhale.Tween(this,{alpha:1,},800)};KWhale.Child.prototype.FadeOut=function(b){KWhale.Tween(this,{alpha:0},600).onComplete(b)};KWhale.Bitmap=function(b){this.img=b;this.alpha=0;this.width=b.width;this.height=b.height};KWhale.Bitmap.prototype=new KWhale.Child;KWhale.Bitmap.prototype.Draw=function(a){a.save();a.globalAlpha=this.alpha;a.translate(this.x,this.y);a.drawImage(this.img,0,0,this.width,this.height);a.restore()};KWhale.Arc=function(d,b){this.r=d;this.angle=0;this.fillColor=b};KWhale.Arc.prototype=new KWhale.Child;KWhale.Arc.prototype.Draw=function(b){b.save();b.beginPath();b.globalAlpha=this.alpha;b.translate(this.x,this.y);b.rotate(this.rotation*Math.PI/180);b.arc(0,0,this.r,0,this.angle/180*Math.PI);b.lineWidth=this.lineWidth;b.lineCap="round";b.strokeStyle=this.fillColor;b.stroke();b.restore()};KWhale.Stage=function(b){this.content=[];this.ctx=b.getContext("2d");this.sw=b.width=innerWidth*devicePixelRatio;this.sh=b.height=innerHeight*devicePixelRatio};KWhale.Stage.prototype.Draw=function(){var b=this;b.ctx.clearRect(0,0,b.sw,b.sh);b.content.forEach(function(a){a.Draw(b.ctx)})};TWEEN={list:[],add:function(a){this.list.push(a)},update:function(){for(var a=0,d=Date.now();this.list[a];){this.list[a].update(d)?a++:this.list.splice(a,1)}},Tween:function(o){var k={},f,i,c,p,n;function g(a){return 1>(a*=2)?a*a/2:-0.5*(--a*(a-2)-1)}for(n in o){k[n]=parseFloat(o[n])}this.to=function(b,a){return i=a,c=b,this};this.start=function(){TWEEN.add(this);f=Date.now();for(var a in c){if(c[a] instanceof Array){if(c[a].length){c[a]=[o[a]].concat(c[a])}}k[a]=o[a]}return this};this.onComplete=function(a){return p=a,this};this.update=function(d){var e;if(f>d){return !0}var a=(d-f)/i,a=1<a?1:a,h=g(a);for(e in c){var b=k[e]||0;o[e]=b+(c[e]-b)*h}if(1==a){p&&p.call(o);return !1}return !0}}};KWhale.Tween=function(c,a,d){return(new TWEEN.Tween(c)).to(a,d).start()};KWhale.Fixed=function(f,g,e){var h=f/g;f/=720;g=g/1135*innerHeight*devicePixelRatio;f=g*h>innerWidth*devicePixelRatio*f?innerWidth*devicePixelRatio*f:g*h;g=f/h;if(!e){return Math.ceil(f)}e.width=Math.ceil(f);e.height=Math.ceil(g)};KWhale.Loading={Init:function(h){var g=this;var a=document.getElementById(h.id);a=new KWhale.Stage(a);var f=new Image;f.crossOrigin="anonymous";f.onload=function(){KWhale.Fixed(140,140,f);f=new KWhale.Bitmap(f);f.x=a.sw/2-f.width/2;f.y=a.sh/4;if(h.text){var d=new Image;d.onload=function(){KWhale.Fixed(355,35,d);d=new KWhale.Bitmap(d);d.x=a.sw/2-d.width/2;d.y=a.sh/2;a.content.push(d);d.FadeIn();g.txt=d};d.src=h.text}a.content.push(f);f.FadeIn();var b=new KWhale.Arc(KWhale.Fixed(108,108),h.color||"#f29700");b.lineWidth=h.width||10;b.x=a.sw/2;b.y=f.y+f.height/2;a.content.push(b);function c(){g.playend=false;b.rotation=-90;KWhale.Tween(b,{alpha:1,angle:360},1000).onComplete(function(){KWhale.Tween(b,{angle:1,alpha:0.2,rotation:270},1000).onComplete(function(){g.playend=true;g.end||c()})})}c();g.logo=f;g.circle=b};f.src=h.logo;KWhale.Go(function(){TWEEN.update();a.Draw();if(g.end&&g.playend){g.End()}})},Stop:function(b){this._a=b;this.end=true},End:function(){this.end=false;var b=this;b.logo.FadeOut();b.txt&&b.txt.FadeOut();b.circle.FadeOut(function(){b._a&&b._a();setTimeout(function(){cancelAnimationFrame(KWhale.running)},0)})}};
